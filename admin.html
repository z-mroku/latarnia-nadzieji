<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Centrum Dowodzenia — Latarnia</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root { --bg:#0f1724; --card:#1e293b; --muted:#94a3b8; --accent:#ff8f00; --accent-2:#ffb74d; font-family: 'Lato', sans-serif; }
    html, body { height:100%; margin:0; background:linear-gradient(180deg,#071224 0%, #081827 60%); color:#e6eef8; }
    .wrap { max-width:1400px; margin:28px auto; padding:18px; }
    .grid { display:grid; gap:20px; }
    .g2 { grid-template-columns:1fr 1fr; }
    .g2-main { display:grid; grid-template-columns: 2fr 1fr; gap: 20px; }
    .g3 { grid-template-columns: repeat(3, 1fr); }
    .card { background:var(--card); padding:20px; border-radius:12px; border:1px solid rgba(255,255,255,0.05); }
    .row { display:flex; gap:10px; align-items:center; }
    h3 { margin-top: 0; color: var(--accent-2); border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;}
    label { display:block; font-size:0.85rem; color:var(--muted); margin-bottom:6px; }
    input, textarea, select { width:100%; padding:10px; border-radius:8px; border:1px solid rgba(255,255,255,0.1); background-color: rgba(0,0,0,0.2); color:#e6eef8; box-sizing:border-box; }
    .list { margin-top:15px; display:flex; flex-direction:column; gap:8px; max-height:400px; overflow-y:auto; padding-right: 5px; }
    .sep { height:1px; background:linear-gradient(90deg,transparent,#ffffff10,transparent); margin:15px 0; }
    .icon-picker { display:flex; gap:8px; flex-wrap:wrap; margin-top:8px; }
    .icon-picker button { background:transparent; border:1px solid rgba(255,255,255,0.1); padding:6px; border-radius:6px; cursor:pointer; color:var(--muted); }
    #liveContent { background:rgba(0,0,0,0.2); padding:10px; border-radius:8px; min-height:160px; line-height: 1.6; }
    
    .ck-editor__editable_inline { background-color: #0f1724 !important; color: #e6eef8 !important; border: 1px solid rgba(255,255,255,0.1) !important; min-height: 400px; }
    .ck-toolbar { background: #0f1724 !important; border-color: rgba(255,255,255,0.1) !important; }
    .ck.ck-button, .ck.ck-button__label { color: var(--muted) !important; }
    .ck.ck-button:hover { background-color: rgba(255,255,255,0.05) !important; }
    .ck.ck-button.ck-on { background: var(--accent-2) !important; color: #0f1724 !important; }
    .ck.ck-dropdown__panel { background: var(--card) !important; border-color: rgba(255,255,255,0.1) !important; }
    .ck.ck-editor__editable.ck-focused { border-color: var(--accent) !important; box-shadow: none !important; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1><i class="fa-solid fa-satellite-dish"></i> Centrum Dowodzenia "Latarnia"</h1>
      <div class="row">
        <a href="index.html" target="_blank" rel="noopener">Podgląd</a>
        <span id="adminEmail">—</span>
        <button id="logoutBtn">Wyloguj</button>
      </div>
    </header>

    <main class="grid" style="margin-top:20px;">
      <section class="card">
        <h3><i class="fa-solid fa-life-ring"></i> Zarządzaj Pomocą</h3>
        <form id="helpForm" class="grid g2" style="margin-top:8px;">
          <div><label for="helpWoj">Województwo</label><select id="helpWoj" required></select></div>
          <div><label for="helpName">Nazwa Ośrodka</label><input id="helpName" required /></div>
          <div><label for="helpAddress">Adres</label><input id="helpAddress" /></div>
          <div><label for="helpPhone">Telefon</label><input id="helpPhone" /></div>
          <div style="grid-column:1/-1"><label for="helpDesc">Opis</label><textarea id="helpDesc" rows="2"></textarea></div>
          <div style="grid-column:1/-1"><label for="helpLink">Link (URL)</label><input id="helpLink" type="url" /></div>
          <div style="grid-column:1/-1" class="row">
            <button id="addHelpBtn" type="submit">Dodaj</button>
            <button id="cancelHelpEditBtn" type="button" style="display:none">Anuluj</button>
            <span id="helpMsg"></span>
          </div>
        </form>
        <div class="sep"></div>
        <div id="helpListContainer" class="list"></div>
      </section>

      <section class="card">
        <h3><i class="fa-solid fa-bars"></i> Menu i Sekcje</h3>
        <form id="menuForm" class="grid g3" style="margin-top:8px;">
          <div><label for="menuText">Tekst</label><input id="menuText" required /></div>
          <div><label for="menuUrl">URL</label><input id="menuUrl" required /></div>
          <div><label for="menuOrder">Kolejność</label><input id="menuOrder" type="number" value="0" /></div>
          <div style="grid-column:1/-1" class="row">
            <button id="addMenuBtn" type="submit">Dodaj</button>
            <button id="cancelMenuEditBtn" type="button" style="display:none">Anuluj</button>
            <span id="menuMsg"></span>
          </div>
        </form>
        <div class="sep"></div>
        <div id="menuListContainer" class="list"></div>
      </section>

      <section class="card" style="grid-column: 1 / -1;">
        <h3><i class="fa-solid fa-pen-to-square"></i> Edytor Wpisów</h3>
        <form id="entryForm" style="margin-top:8px;">
          <div class="grid g2">
            <div><label for="sectionSelect">Sekcja</label><select id="sectionSelect"></select></div>
            <div><label for="authorInput">Autor</label><input id="authorInput" /></div>
            <div style="grid-column:1/-1">
              <label for="titleInput">Tytuł (wstaw ikonę klikając poniżej)</label>
              <input id="titleInput" />
              <div class="icon-picker" id="iconPicker"></div>
            </div>
            <div style="grid-column:1/-1">
              <label for="contentInput">Treść</label>
              <textarea id="contentInput"></textarea>
            </div>
            <div class="row">
              <button id="publishBtn" type="submit">Opublikuj</button>
              <button id="cancelEntryEditBtn" type="button" style="display:none">Anuluj</button>
              <span id="formMsg"></span>
            </div>
          </div>
        </form>
      </section>
      <div class="g2-main">
        <section class="card">
            <h3><i class="fa-solid fa-list-check"></i> Lista Wpisów</h3>
            <div class="grid g3" style="margin-top:8px;">
              <div><label for="filterSection">Filtruj</label><select id="filterSection"></select></div>
              <div><label for="searchInput">Szukaj</label><input id="searchInput" /></div>
              <div><label for="sortSelect">Sortuj</label>
                <select id="sortSelect">
                  <option value="desc">Najnowsze</option>
                  <option value="asc">Najstarsze</option>
                  <option value="title">Tytuł A→Z</option>
                </select>
              </div>
            </div>
            <div id="entriesList" class="list"></div>
        </section>
        <section class="card">
          <h3><i class="fa-solid fa-eye"></i> Podgląd na Żywo</h3>
          <div id="liveTitle"></div>
          <div id="liveMeta"></div>
          <div id="liveContent"></div>
          <button id="ttsPreviewBtn">Odsłuchaj Podgląd</button>
          <div id="readerStatus">Lektor: gotowy</div>
        </section>
      </div>

      <div class="grid g3">
        <section class="card">
          <h3><i class="fa-solid fa-wand-magic-sparkles"></i> Iskierki</h3>
          <form id="sparkForm">
            <input id="sparkInput" /><button type="submit">Dodaj</button>
          </form>
          <div id="sparksList" class="list"></div>
        </section>
        <section class="card">
          <h3><i class="fa-solid fa-music"></i> Playlista</h3>
          <form id="playlistForm" class="grid g2">
            <input id="songTitle" placeholder="Tytuł" />
            <input id="songLink" placeholder="URL" />
            <button type="submit">Dodaj</button>
          </form>
          <div id="playlistList" class="list"></div>
        </section>
        <section class="card">
          <h3><i class="fa-solid fa-headphones-simple"></i> Lektor</h3>
          <p id="readerSelectionInfo">Zaznacz wpis na liście, by go odsłuchać.</p>
          <button id="ttsListenBtn" disabled>Odsłuchaj</button>
        </section>
      </div>

      <section class="card">
        <h3><i class="fa-solid fa-images"></i> Galeria</h3>
        <form id="galleryForm" class="grid g3">
            <div><label for="galleryDesc">Opis</label><input id="galleryDesc" /></div>
            <div><label for="galleryUpload">Plik</label><input id="galleryUpload" type="file" accept="image/*" /></div>
            <div><label>&nbsp;</label><button type="submit" style="width:100%">Wyślij</button></div>
        </form>
        <progress id="galleryProgressBar" value="0" max="100"></progress>
        <div id="galleryList" class="list"></div>
      </section>

      <section class="card">
        <h3><i class="fa-solid fa-sticky-note"></i> Notatki</h3>
        <form id="noteForm">
            <div><label for="noteTitle">Tytuł</label><input id="noteTitle" required /></div>
            <div style="margin-top:10px;"><label for="noteContent">Treść</label><textarea id="noteContent" rows="2" required></textarea></div>
            <div style="margin-top:10px;" class="row">
              <button id="addNoteBtn" type="submit">Dodaj</button>
              <button id="cancelNoteEditBtn" type="button" style="display:none">Anuluj</button>
              <span id="noteMsg"></span>
            </div>
        </form>
        <div id="noteListContainer" class="list"></div>
      </section>
    </main>
    <footer><div class="muted-small">© 2025 Od Dna do Światła — Panel administracyjny</div></footer>
  </div>

  <script src="https://cdn.ckeditor.com/ckeditor5/41.4.2/super-build/ckeditor.js"></script>
  
  <script type="module" src="/js/admin.js"></script>

</body>
</html>
